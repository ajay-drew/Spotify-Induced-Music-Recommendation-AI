services:
  # ──────────────────────────────
  # Backend: FastAPI + Uvicorn (Docker) — Web Service (free tier supported)
  # ──────────────────────────────
  - type: web
    name: simrai-api
    env: docker                     # Uses your existing Dockerfile
    region: oregon
    plan: free                      # Valid for Web Services
    autoDeploy: true
    healthCheckPath: /health

    envVars:
      - key: SIMRAI_SPOTIFY_CLIENT_ID
        sync: false                 # Enter secret in dashboard
      - key: SIMRAI_SPOTIFY_CLIENT_SECRET
        sync: false
      - key: GROQ_API_KEY
        sync: false
      - key: SIMRAI_LOG_LEVEL
        value: INFO

  # ──────────────────────────────
  # Frontend: React + Vite → Static Site (always free; no plan field)
  # ──────────────────────────────
  - type: web
    name: simrai
    env: static                     # This makes it a Static Site
    autoDeploy: true

    buildCommand: >-
      cd web &&
      npm ci &&
      npm run build

    staticPublishPath: web/dist     # Vite's output folder

    envVars:
      - key: VITE_API_URL
        value: https://simrai-api.onrender.com

